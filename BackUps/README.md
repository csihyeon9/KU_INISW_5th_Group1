
# PyTorch Geometric을 활용한 이질적 그래프 링크 예측

이 프로젝트는 **PyTorch Geometric**을 사용하여 **이질적 그래프**에서 **링크 예측**을 수행하는 예제입니다. 
이 작업은 그래프의 노드 간 관계(엣지 존재 여부)를 예측하는 것을 목표로 하며, **HANConv** 기반 신경망을 활용합니다.

---

## **목차**
1. [프로젝트 개요](#프로젝트-개요)
2. [핵심 개념](#핵심-개념)
3. [코드 워크플로우](#코드-워크플로우)
4. [모델 세부 사항](#모델-세부-사항)
5. [결과](#결과)
6. [사용법](#사용법)
7. [감사의 말](#감사의-말)

---

## **프로젝트 개요**
이 프로젝트에서는:
- **단어**를 그래프의 **노드**로 사용합니다.
- **주제**에 따라 단어들 간의 관계를 **엣지**로 정의합니다.
- 주어진 노드의 특징과 관계를 활용해 노드 간 **엣지 존재 여부**를 예측합니다.

이 프로젝트는 **PyTorch Geometric**을 사용하여 구현되었으며, **Heterogeneous Graph Attention Network (HAN)**을 활용하여 노드 임베딩을 학습하고 링크 예측을 수행합니다.

---

## **핵심 개념**

### **그래프 용어**
- **노드(Node)**: 데이터의 개별적인 요소 (예: 단어).
- **엣지(Edge)**: 두 노드 간의 관계를 나타냄.
- **속성(Attribute)**:
  - **노드 속성**: 노드 정체성을 나타내는 One-hot Encoding.
  - **엣지 속성**: 관계(주제)를 나타내는 범주형 라벨.

### **그래프 유형**
- **이질적 그래프(Heterogeneous Graph)**:
  - 여러 유형의 노드와 엣지를 포함하는 그래프.
  - 예: 단어가 주제에 따라 연결된 그래프.

### **링크 예측**
- 두 노드 간 엣지 존재 여부를 예측하는 작업.
- 주요 응용 분야:
  - 추천 시스템.
  - 소셜 네트워크 분석.
  - 지식 그래프 완성.

---

## **코드 워크플로우**

### **1. 데이터 준비**
1. **노드**:
   - `word` 타입 노드로 표현.
   - **One-hot Encoding**으로 특징을 초기화.

2. **엣지**:
   - 실제 엣지는 데이터셋에서 추출.
   - 부정 엣지는 **네거티브 샘플링**을 통해 생성.

3. **이질적 그래프 데이터**:
   - `torch_geometric.data.HeteroData`를 사용해 구성.

### **2. 모델 설계**
링크 예측 모델 구성:
1. **HANConv**:
   - 이질적 그래프에서 노드 임베딩을 생성.
2. **엣지 예측기**:
   - 두 노드 임베딩을 결합하여 엣지 존재 여부를 예측.

### **3. 학습 및 평가**
1. **손실 함수**:
   - 이진 크로스 엔트로피 손실(`BCEWithLogitsLoss`).
2. **옵티마이저**:
   - Adam 옵티마이저와 가중치 감쇠 사용.
3. **평가 지표**:
   - 손실, 정확도, ROC-AUC 등.

---

## **모델 세부 사항**

### **1. HANLinkPredictor**
모델 아키텍처:
- **HANConv 레이어**:
  - 입력: 노드 특징, 엣지 인덱스.
  - 출력: 학습된 노드 임베딩.
- **선형 엣지 예측기**:
  - 입력: 두 노드 임베딩의 결합.
  - 출력: 엣지 예측 값.

### **2. 학습 루프**
- **순전파**:
  - 입력: 노드 특징, 엣지 인덱스, 엣지 라벨 인덱스.
  - 출력: 엣지 존재 확률.
- **역전파**:
  - `BCEWithLogitsLoss`로 손실 계산.
  - Adam 옵티마이저로 모델 가중치 업데이트.

---

## **결과**

### **학습 성능**
1. **손실**:
   - 에포크가 진행될수록 감소.
2. **정확도**:
   - 모델이 엣지 패턴을 학습함에 따라 점진적으로 증가.

### **예측 결과 예시**
첫 5개의 엣지 예측:
```
Edge 10 -> 23, Prediction: 0.8912, Label: 1
Edge 45 -> 67, Prediction: 0.1234, Label: 0
Edge 11 -> 89, Prediction: 0.7568, Label: 1
Edge 56 -> 78, Prediction: 0.0456, Label: 0
Edge 30 -> 44, Prediction: 0.9234, Label: 1
```

---

## **사용법**

### **필수 라이브러리 설치**
```bash
pip install torch torch-geometric matplotlib
```

### **코드 실행**
1. 데이터와 모델 초기화.
2. 학습 루프 실행.
3. 결과 시각화.

---

## **감사의 말**
이 프로젝트는 다음의 주요 리소스를 활용합니다:
- **[PyTorch Geometric](https://pytorch-geometric.readthedocs.io/)**: 그래프 데이터 처리 및 모델링.
- **Heterogeneous Graph Neural Networks** 개념.

기여, 문의 또는 피드백이 있다면 언제든 공유해주세요!
